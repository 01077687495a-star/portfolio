# 테스트 자동화
---
playwright를 이용해 결제시스템 테스트를 자동화 해보았습니다.

실제 결제창에서 테스트하기에는 어려움이 있어 mock page를 직접 만들어보았습니다.

## playwright를 선택한 이유
* 한번의 스크립트 작성으로 여러 브라우저에서 한꺼번에 테스트 가능해 테스트 자원을 절약할 수 있습니다.
* playwright는 요소가 나타날때 까지 자동으로 기다려주므로 테스트 신뢰도를 높이고 유지보수 비용을 절감할 수 있습니다.
* 테스트에 실패한 경우의 타임라인별 스크린샷과 로그를 기록해 디버깅에 유리합니다.
* selenium은 웹요소에 http 요청을 보내는 방식을 가지지만<br>
  playwright는 브라우저와 직접 통신하는 websocket 방식을 사용하여 실행속도가 매우 빠릅니다.<br>

## 결제시스템을 대상으로 한 이유
* 매출과 직결되는 매우 민감한 영역입니다.<br>
  조금의 장애도 막대한 손실로 이루어질 수 있어 자동화를 통한 상시 모니터링 및 리그레션 테스트가 필수적이라 생각했습니다.<br>
* 결제시스템은 기술적으로 복잡한 부분이 많아 이러한 복잡한 로직들을 자동화함으로써 인적오류를 줄이고 수동테스트의 피로도를 줄일 수 있습니다.


## mock page 구현 기능
* 충전하고 싶은 금액 입력
* 결제 약관에 동의 (체크박스 활성화)
* 결제 수단 선택
* 금액입력과 결제 수단, 약관 동의 체크박스 활성화를 모두 충족해야 결제버튼 활성화
* 결제수단으로 카드를 고를 경우 은행 점검시간으로 인한 결제취소 팝업창 생성 ( 어떤 경우에서든 우선적으로 로직적용)
* 1000원 이상 입력, 결제수단 카카오페이 선택 시 입력한 금액과 결제 성공을 알려주는 팝업창 생성
* 1000원 미만 입력, 결제수단 카카오페이 선택 시 최소 입력 가능 금액과 결제 실패를 알려주는 팝업창 생성
* 100000원 이상 입력, 결제수단 카카오페이 선택 시 잔액부족으로 인한 결제 실패 팝업창 생성



[mock page 소개 영상]




https://github.com/user-attachments/assets/059994ed-602d-476d-aae0-d896d4b15166






[테스트 자동화 영상(3.5배속)]



https://github.com/user-attachments/assets/71150b29-d2c4-4ed2-af98-1043b3bd77af




https://github.com/user-attachments/assets/c4933cf6-37c8-4adc-9730-6bb9beb70e14





## 자동화 시나리오 요약
* **시나리오 A - 필수조건 누락시 결제버튼 비활성화**
  1. 금액만 입력한 경우 -> 결제 버튼 비활성화
  2. 결제수단만 고른 경우 -> 결제 버튼 비활성화
  3. 약관 동의 박스 체크만 한 경우 -> 결제 버튼 비활성화
  4. 금액만 입력하지 않은 경우 -> 결제 버튼 비활성화
  5. 결제수단만 고르지 않은 경우 -> 결제 버튼 비활성화
  6. 약관 동의 박스 체크만 하지 않은 경우 -> 결제 버튼 비활성화
    
* **시나리오 B - 결제수단을 카드로 고른 경우 은행 시스템 점검으로 인한 결제취소 팝업 생성 로직이 우선 적용 되는지**
  1. 500원 입력 후 결제 버튼 클릭 -> 은행 시스템 점검으로 인한 결제 취소 팝업 생성 확인
  2. 1000원 입력 후 결제 버튼 클릭 -> 은행 시스템 점검으로 인한 결제 취소 팝업 생성 확인
  3. 100000원 입력 후 결제 버튼 클릭 -> 은행 시스템 점검으로 인한 결제 취소 팝업 생성 확인
    
* **시나리오 C - 결제수단을 카카오페이로 고른 후 금액별 분기 검증**
    1. 500원 입력 후 결제 버튼 클릭 -> 최소 결제금액 미달로 인한 결제 취소 팝업 생성 확인
    2. 1000원 입력 후 결제 버튼 클릭 -> 입력한 금액과 결제 성공 팝업 생성 확인
    3. 100000원 입력 후 결제 버튼 클릭 -> 잔액 부족으로 인한 결제 취소 팝업 생성 확인
   
크롬, 파이어폭스, webkit 세가지 브라우저로 한꺼번에 테스트 진행.

## 트러블슈팅 구간

**문제**: 웹 디자인을 위해 결제 수단 라디오 버튼(input)을 display: none으로 숨겨둔 결과,<br>
테스트 자동화 도구가 해당 요소를 '보이지 않음'으로 판단하여 상호작용에 실패하는 현상이 발생했습니다.<br>
초기에는 { force: true } 옵션으로 강제 클릭을 시도했으나, 이는 실제 사용자의 행동 방식과는 차이가 있었습니다.<br>

**해결 방안**: 숨겨진 input 대신 사용자가 실제로 클릭하는 영역인 <label> 태그의 텍스트("카드", "카카오")를 직접 타겟팅하여 클릭하도록 스크립트를 개선했습니다.<br>
이를 통해 실제 사용자 경험(UX)과 일치하는 견고한 테스트를 구현할 수 있었습니다.<br>





[테스트 리포트 요약]





https://github.com/user-attachments/assets/5455cd36-1ab5-4ef6-8ff8-6ca2cc727be0














